if(void 0===WannaSale||!WannaSale)var WannaSale={};WannaSale.Lang=void 0!==WannaSale.Lang&&WannaSale.Lang?WannaSale.Lang:{isUndefined:function(e){return void 0===e},isString:function(e){return"string"==typeof e}},WannaSale.Settings=void 0!==WannaSale.Settings&&WannaSale.Settings?WannaSale.Settings:{widgetKey:{},lang:{},currency:{},setWithData:function(e,t,n){this.widgetKey=e,this.lang=t,this.currency=n}},WannaSale.DOM=void 0!==WannaSale.DOM&&WannaSale.DOM?WannaSale.DOM:{iti:{},settings:{},get:function(e){return e&&e.nodeType?e:document.getElementById(e)},addListener:function(e,t,n){WannaSale.Lang.isString(e)&&(e=this.get(e)),e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},removeListener:function(e,t,n){WannaSale.Lang.isString(e)&&(e=this.get(e)),e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=function(){return!0}},purge:function(e){var t,n,a,l=e.attributes;if(l)for(n=l.length,t=0;t<n;t+=1)"function"==typeof e[a=l[t].name]&&(e[a]=null);if(l=e.childNodes)for(n=l.length,t=0;t<n;t+=1)WannaSale.DOM.purge(e.childNodes[t])},setInnerHTML:function(e,t){return e&&"string"==typeof t?(function(e){var t,n,a,l,o=e.attributes;if(o)for(n=o.length,t=0;t<n;t+=1)"function"==typeof e[a=o[t].name]&&(e[a]=null);if(o=e.childNodes)for(n=o.length,t=0;t<n;t+=1)l=e.childNodes[t],arguments.callee(l),WannaSale.DOM.purge(l)}(e),e.innerHTML=t.replace(/<script[^>]*>[\S\s]*?<\/script[^>]*>/gi,""),e.firstChild):null},getVendorDomain:function(){var e=document.getElementById("wannaSaleWidget").src;return e.split(/\/+/)[0]+"//"+e.split(/\/+/)[1]},getClientIP:function(){var e=new XMLHttpRequest;if(e.open("GET","https://api.ipify.org?format=jsonp&callback=",!1),e.send(),200==e.status)return JSON.parse(e.responseText.replace("(","").replace(")","").replace(";","")).ip},getCountryFromIP:function(){var t,e=WannaSale.DOM.getClientIP();if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}if(t.open("GET","//ipinfo.io/"+(e||""),!1),t.setRequestHeader("Accept","application/json"),t.send(null),200==t.status){var n=t.responseText;return JSON.parse(n).country}},getGeoDataFromIP:function(){WannaSale.DOM.getClientIP();var e=new XMLHttpRequest;if(e.open("GET","https://api.sypexgeo.net/json",!1),e.send(),200==e.status)return JSON.parse(e.responseText)},getWidgetButton:function(e,t,n,a,l,o,i,r,d){var s=document.createElement("button");return s.id="wannaPrice",s.innerHTML=a,s.style.backgroundColor=l,s.style.color=o,s.style.fontSize=d+"px",s.style.width=i+"px",s.style.height=r+"px","1"==e&&(s.style.position="fixed",s.style.left=n+"px",s.style.bottom=t+"px"),"2"==e&&(s.style.position="fixed",s.style.right=n+"px",s.style.bottom=t+"px"),"3"==e&&(s.style.position="static"),s.outerHTML},getWidgetRelatedButton:function(e,t,n,a,l,o,i,r,d,s){var u=document.createElement("button");return u.className="wannaSaleButton",u.innerHTML=a,u.style.backgroundColor=l,u.style.color=o,u.style.position="relative",u.style.height=d+"px",u.style.border="0",u.style.fontSize=s+"px",u.style.cursor="pointer",u.style.borderRadius="4px",u.style.width=1==r?i+"%":i+"px",u.outerHTML},setOverlay:function(){var e=document.createElement("div");e.className="wannaSaleOverlay",e.style.backgroundColor="rgba(0, 0, 0, 0.8)",e.style.position="fixed",e.style.width="100%",e.style.height="100%",e.style.left="0px",e.style.top="0px",e.style.zIndex="999997",document.body.appendChild(e)},removeOverlay:function(){for(var e=document.getElementsByClassName("wannaSaleOverlay"),t=0;t<e.length;++t){e[t].remove()}},setFinalMessage:function(e,t,n){var a=document.createElement("p");return a.className="wannaSaleMessage",a.style.padding="30px 40px 30px 40px",a.style.textAlign="center",a.style.fontSize="13px",a.style.position="fixed",a.style.top="50%",a.style.left="50%",a.style.transform="translate(-50%, -50%)",a.style.backgroundColor=n,a.style.color=t,a.style.zIndex="999998",a.innerHTML=e,document.body.appendChild(a),a.outerHTML},refreshFormFields:function(){null!==document.getElementById("wannaSaleItemId")&&(document.getElementById("wannaSaleItemId").value=""),null!==document.getElementById("wannaSaleItemName")&&(document.getElementById("wannaSaleItemName").value=""),document.getElementById("wannaSaleName").value="",document.getElementById("wannaSaleEmail").value="",null!==document.getElementById("wannaSalePhone")&&(document.getElementById("wannaSalePhone").value=""),document.getElementById("wannaSalePrice").value=""},removeMessage:function(){for(var e=document.getElementsByClassName("wannaSaleMessage"),t=0;t<e.length;++t){e[t].remove()}},setWindowSettings:function(e,t,n,a,l,o,i,r,d,s){var u=document.getElementById("wannaSaleForm");1==e&&(u.style.position="fixed",u.style.left=t+"px",u.style.bottom=n+"px"),2==e&&(u.style.position="fixed",u.style.right=t+"px",u.style.bottom=n+"px"),3==e&&(u.style.position="fixed",u.style.top="50%",u.style.left="50%",u.style.transform="translate(-50%, -50%)");document.getElementById("wannaSaleTitle");document.getElementById("wannaSaleText").innerText=o,document.getElementById("wannaCheckLabel").innerText=i;var m=document.getElementById("wannaSaleSubmit");m.innerText=r,m.style.backgroundColor=d,m.style.color=s},validateForm:function(){var e=document.getElementById("widgetTextStatus");e.innerText="";var t=document.getElementById("wannaSaleItemName");if(null!==t){if(""==t.value)return t.style.borderBottom="1px solid #ff4d00",!(e.innerHTML="Введите информацию о товаре.");t.style.borderBottom="0px solid #ff4d00"}var n=document.getElementById("wannaSaleName");if(null!==n){if(!new RegExp(/^[а-яА-яAa-zA-z\-\ ]/i).test(n.value))return n.style.borderBottom="1px solid red",!(e.innerHTML="Введите своё имя корректно.");n.style.borderBottom="0px solid red"}var a=document.getElementById("wannaSaleEmail");if(null!==a){if(!new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(a.value))return a.style.borderBottom="1px solid red",!(e.innerHTML="Введите свой адрес электронной почты корректно.");a.style.borderBottom="0px solid red"}if(null!==document.getElementById("wannaSalePhone")){var l=document.getElementById("wannaSalePhone");if(null!==l){if(""==l.value)return l.style.borderBottom="1px solid red",!(e.innerHTML="Введите номер телефона.");l.style.borderBottom="0px solid red"}}var o=document.getElementById("wannaSalePrice");if(null!==o){if(!new RegExp(/^[0-9]/i).test(o.value))return o.style.borderBottom="1px solid red",!(e.innerHTML="Введите цену корректно.");o.style.borderBottom="0px solid red"}var i=document.getElementById("wannaCheck");if(null!==i&&!1===i.checked)return!(e.innerHTML="Вы не подтвердили согласие на обработку данных.");for(var r=document.getElementsByClassName("wannaSaleCustomField"),d=0;d<r.length;++d){var s=r[d].value,u=r[d].dataset.type;r[d].dataset.title;if("word"==u){if(!new RegExp(/^[а-яА-яAa-zA-z\-\ ]/i).test(s))return e.innerHTML="Значение поля "+r[d].dataset.title.toLowerCase()+" должно быть строкой.",!1}else if("integer"==u){if(!new RegExp(/^[0-9]/i).test(s))return e.innerHTML="Значение поля "+r[d].dataset.title.toLowerCase()+" должно быть числом.",!1}else if("text"==u&&""==u)return e.innerHTML="Значение поля "+r[d].dataset.title.toLowerCase()+" должно быть текстом.",!1}return!0}},WannaSale.Ajax=void 0!==WannaSale.Ajax&&WannaSale.Ajax?WannaSale.Ajax:{initWidget:function(e){var t=new XMLHttpRequest;if(t.open("POST",WannaSale.DOM.getVendorDomain()+"/api/v1/displayWidget",!1),t.setRequestHeader("Authorization",e.key),t.setRequestHeader("Accept-Language",e.lang),t.setRequestHeader("Currency",e.currency),t.setRequestHeader("Url",window.location),t.send(),200!=t.status)return null;if(4==t.readyState&&200==t.status&&t.responseText){var n=JSON.parse(t.response);if(!0===n.data.load){var a=n.data.display_settings;n.data.custom_fields;WannaSale.Button.render(a,e.key,n.data.session_key),WannaSale.Window.render(a,n.data.content,e.key,e.lang,e.currency,n.data.session_key)}}},sendOpenRequest:function(e,t){var n=WannaSale.DOM.getClientIP(),a=e,l=new XMLHttpRequest,o=new FormData;o.append("session_key",t),l.open("POST",WannaSale.DOM.getVendorDomain()+"/api/v1/setWidgetOpen",!0),l.setRequestHeader("Authorization",a),l.setRequestHeader("IP",n),l.setRequestHeader("Url",window.location),l.setRequestHeader("X-User-Agent",navigator.userAgent),l.send(o)},sendRequest:function(e,t,n){var a=WannaSale.DOM.getClientIP(),l=e,o=new XMLHttpRequest,i=new FormData;null!==document.getElementById("wannaSaleItemId")&&i.append("item_id",document.getElementById("wannaSaleItemId").value),null!==document.getElementById("wannaSaleItemName")&&i.append("item_name",document.getElementById("wannaSaleItemName").value),i.append("session_key",document.getElementById("wannaSaleSessionKey").value),i.append("name",document.getElementById("wannaSaleName").value),i.append("email",document.getElementById("wannaSaleEmail").value),null!==document.getElementById("wannaSalePhone")&&(i.append("phone",document.getElementById("wannaSalePhone").value),i.append("country",document.getElementById("wannaSaleCountryCode").value)),i.append("offered_price",document.getElementById("wannaSalePrice").value),i.append("currency",n),i.append("ip_city",document.getElementById("wannaSaleIpCity").value),i.append("ip_country",document.getElementById("wannaSaleIpCountry").value);for(var r=document.getElementsByClassName("wannaSaleCustomField"),d=0;d<r.length;++d){var s=r[d].name,u=r[d].dataset.title,m=r[d].value,c=JSON.stringify({name:s,title:u,value:m});console.log(c),i.append("custom_fields[]",c)}if(o.open("POST",WannaSale.DOM.getVendorDomain()+"/api/v1/setWidgetRequest",!1),o.setRequestHeader("Authorization",l),o.setRequestHeader("IP",a),o.setRequestHeader("Url",window.location),o.setRequestHeader("Accept-Language",t),o.setRequestHeader("X-User-Agent",navigator.userAgent),o.send(i),200==o.status){if(4==o.readyState&&200==o.status&&o.responseText){var g=document.getElementById("wannaSaleSettings").dataset.messageText,y=document.getElementById("wannaSaleSettings").dataset.messageTextColor,p=document.getElementById("wannaSaleSettings").dataset.messageBackgroundColor;WannaSale.DOM.setFinalMessage(g,y,p),JSON.parse(o.response);document.getElementById("wannaSaleForm").style.display="none",setTimeout(function(){WannaSale.DOM.removeMessage(),WannaSale.DOM.removeOverlay(),WannaSale.DOM.refreshFormFields()},5e3),WannaSale.Dialog.show(WannaSale.Settings.widgetKey,WannaSale.Settings.lang,WannaSale.Settings.currency)}}else if(422==o.status&&null!==document.getElementById("wannaSalePhone")){var S=document.getElementById("widgetTextStatus");S.innerText="",document.getElementById("wannaSalePhone").style.border="1px solid red",S.innerHTML="Неверный формат номера телефона."}}},WannaSale.Button=void 0!==WannaSale.Button&&WannaSale.Button?WannaSale.Button:{render:function(t,n,a){var e=document.createElement("div");if(document.body.appendChild(e),"3"==t.position){for(var l=WannaSale.DOM.getWidgetRelatedButton(t.position,t.bottom,t.side,t.button_text,t.button_color,t.button_text_color,t.button_width,t.button_width_percent,t.button_height,t.button_font_size),o=document.getElementsByClassName("wannaSaleButton"),i=0;i<o.length;++i){o[i].outerHTML=l}var r=document.getElementsByClassName("wannaSaleButton"),d=function(){WannaSale.DOM.setOverlay(),WannaSale.Button.click(t),WannaSale.Ajax.sendOpenRequest(n,a)};for(i=0;i<r.length;i++)r[i].addEventListener("click",d,!1)}else{l=WannaSale.DOM.getWidgetButton(t.position,t.bottom,t.side,t.button_text,t.button_color,t.button_text_color,t.button_width,t.button_height,t.button_font_size);WannaSale.DOM.setInnerHTML(e,l),WannaSale.DOM.addListener("wannaPrice","click",function(e){return WannaSale.Button.click(t),WannaSale.Ajax.sendOpenRequest(n,a),WannaSale.DOM.setOverlay(),!1})}},click:function(e){(document.getElementById("wannaSaleForm").style.display="block","3"!=e.position)&&(document.getElementById("wannaPrice").style.display="none");return!1}},WannaSale.Window=void 0!==WannaSale.Window&&WannaSale.Window?WannaSale.Window:{render:function(e,t,n,a,l,o){var i=document.createElement("div");i.innerHTML=t,document.body.appendChild(i),WannaSale.DOM.setWindowSettings(e.position,e.side,e.bottom,e.title_text,e.title_color,e.text,e.checkbox_text,e.window_button_text,e.window_button_color,e.window_button_text_color,e.show_phone),document.getElementById("wannaSalePhone"),WannaSale.DOM.addListener("wannaSaleClose","click",function(e){document.getElementById("wannaSaleForm").style.display="none";var t=document.getElementById("wannaPrice");return null!==t&&(t.style.display="block"),WannaSale.DOM.removeOverlay(),!1}),WannaSale.DOM.addListener("wannaSaleSubmit","click",function(e){WannaSale.Window.submit(n,a,l)}),WannaSale.DOM.addListener("selectedCountry","click",function(e){document.getElementById("selectCountry").style.display="block"});var r=new IMask(document.getElementById("wannaSalePhone"),{mask:"0 000 000 00 00"});document.getElementById("wannaSalePhone").setAttribute("placeholder","0 000 000 00 00"),document.getElementById("wannaSaleSessionKey").value=o;var d=WannaSale.DOM.getGeoDataFromIP(),s=d.city.name_ru,u=d.country.name_ru,m=d.country.iso;document.getElementById("wannaSaleCountryCode").value=m,document.getElementById("wannaSaleIpCountry").value=u,document.getElementById("wannaSaleIpCity").value=s;var c=document.getElementById("selectCountry");c.addEventListener("click",function(e){if("LI"===e.target.tagName){var t=e.target.getAttribute("data-iso"),n=e.target.getAttribute("data-mask");(l=document.getElementById("wannaSalePhone")).value="",l.setAttribute("placeholder",n),document.getElementById("wannaSaleCountryCode").value=t,r.updateOptions({mask:n});var a=e.target.querySelector("img");document.getElementById("selectedCountryImg").setAttribute("src",a.getAttribute("src"))}else{var l;t=e.target.parentNode.getAttribute("data-iso"),n=e.target.parentNode.getAttribute("data-mask");if((l=document.getElementById("wannaSalePhone")).value="",l.setAttribute("placeholder",n),document.getElementById("wannaSaleCountryCode").value=t,r.updateOptions({mask:n}),"IMG"===e.target.tagName){a=e.target;document.getElementById("selectedCountryImg").setAttribute("src",a.getAttribute("src"))}else e.target.tagName}c.style.display="none"})},cookiesCatch:function(){},initCountryCode:function(){var e=WannaSale.DOM.getGeoDataFromIP(),t=e.city.name_ru,n=e.country.name_ru,a=e.country.iso,l=document.getElementById("wannaSalePhone"),o=document.getElementById("wannaSaleCountryCode");document.getElementById("wannaSaleIpCity").value=t,document.getElementById("wannaSaleIpCountry").value=n,o.value=a;var r=intlTelInput(l,{initialCountry:a.toLowerCase()});WannaSale.DOM.iti=r;var d=l.getAttribute("placeholder").replace(/[1-9]/g,"0"),s=(new IMask(document.getElementById("wannaSalePhone"),{mask:d}),document.getElementsByClassName("country"));for(i=0;i<s.length-1;i++)s[i].addEventListener("click",function(){(o=document.getElementById("wannaSaleCountryCode")).value=this.getAttribute("data-country-code"),setTimeout(function(){l.value="";var e=l.getAttribute("placeholder").replace(/[1-9]/g,"0");new IMask(document.getElementById("wannaSalePhone"),{mask:e})},100)})},submit:function(e,t,n){WannaSale.DOM.validateForm()&&WannaSale.Ajax.sendRequest(e,t,n)}},WannaSale.Dialog=void 0!==WannaSale.Dialog&&WannaSale.Dialog?WannaSale.Dialog:{show:function(e){if(void 0!==e.key&&void 0!==WannaSale.DOM.getVendorDomain()){var t=WannaSale.Settings.setWithData(e.key,e.lang,e.currency);WannaSale.DOM.settings=t,WannaSale.Ajax.initWidget(e)}}};